<!-- pvp.html -->

<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>DreamX ‚Ä¢ PvP</title>

  <link rel="stylesheet" href="/src/css/tokens.css" />
  <link rel="stylesheet" href="/src/css/layout.css" />
  <link rel="stylesheet" href="/src/css/pvp.css" />

</head>

<body class="dx theme-light">
<div class="dx-app">

  <!-- TOP BAR -->
  <header class="dx-topbar">
    <div class="dx-topbar__inner">
      <div class="dx-brand">
        <div class="dx-brand__logo">DX</div>
        <div class="dx-brand__text">
          <div class="dx-brand__title">PvP</div>
          <div class="dx-brand__subtitle">1 vs 1</div>
        </div>
      </div>
      <div class="dx-chip">Live</div>
    </div>
  </header>

  <!-- CONTENT -->
  <main class="dx-content">
    <section class="dx-game-card">

      <h1 style="margin-top:0">–ö–∞–º—ñ–Ω—å ‚Ä¢ –ù–æ–∂–∏—Ü—ñ ‚Ä¢ –ü–∞–ø—ñ—Ä</h1>

      <p id="pvp-status" class="dx-game-status">
        –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ —á–µ—Ä–≥–∏...
      </p>

      <!-- Buttons -->
      <div class="dx-rps-buttons">
        <button class="dx-rps-btn" data-move="rock">ü™® –ö–∞–º—ñ–Ω—å</button>
        <button class="dx-rps-btn" data-move="scissors">‚úÇÔ∏è –ù–æ–∂–∏—Ü—ñ</button>
        <button class="dx-rps-btn" data-move="paper">üìÑ –ë—É–º–∞–≥–∞</button>
      </div>

      <button class="dx-btn dx-btn--primary"
              style="margin-top:12px"
              onclick="window.location.href='./index.html'">
        –ù–∞–∑–∞–¥
      </button>

    </section>
  </main>

  <!-- BOTTOM BAR -->
  <footer class="dx-bottombar">
    <div class="dx-bottombar__inner">
      <div class="dx-bottombar__label">
        Created by Oleksandr Krychylskyi
      </div>
    </div>
  </footer>

</div>

<!-- JS -->
<script src="/src/js/dreamx_core.js"></script>
<script src="/src/js/api_client.js"></script>
<script src="/src/js/pvp_client.js"></script>
<script src="/src/js/pvp_screen.js"></script>

<script>
  const statusEl = document.getElementById("pvp-status");

  function setStatus(text) {
    statusEl.textContent = text;
  }

  // ===== HOOK EVENTS =====

  PvPScreen.events.onQueueJoined = () => {
    setStatus("üîç –ü–æ—à—É–∫ —Å—É–ø–µ—Ä–Ω–∏–∫–∞...");
  };

  PvPScreen.events.onWaitingOpponent = () => {
    setStatus("‚è≥ –û—á—ñ–∫—É—î–º–æ –¥—Ä—É–≥–æ–≥–æ –≥—Ä–∞–≤—Ü—è...");
  };

  PvPScreen.events.onMatchStarted = () => {
    setStatus("‚öîÔ∏è –ì—Ä–∞ –ø–æ—á–∞–ª–∞—Å—å! –ó—Ä–æ–±–∏ —Ö—ñ–¥ üëá");
  };

  PvPScreen.events.onCanMove = () => {
    setStatus("üéØ –¢–≤—ñ–π —Ö—ñ–¥");
  };

  PvPScreen.events.onRoundResolved = (res) => {
    setStatus("‚úÖ –•—ñ–¥ –∑–∞—Ä–∞—Ö–æ–≤–∞–Ω–æ");
  };

  PvPScreen.events.onError = (err) => {
    console.error(err);
    setStatus("‚ö†Ô∏è –ü–æ–º–∏–ª–∫–∞ PvP");
  };

  // ===== BUTTONS =====

  document.querySelectorAll("[data-move]").forEach(btn => {
    btn.addEventListener("click", () => {
      PvPScreen.sendMove(btn.dataset.move);
      setStatus("‚è≥ –û—á—ñ–∫—É—î–º–æ —Ö—ñ–¥ —Å—É–ø–µ—Ä–Ω–∏–∫–∞...");
    });
  });

  // ===== START =====
  PvPScreen.start();
</script>

</body>
</html>
